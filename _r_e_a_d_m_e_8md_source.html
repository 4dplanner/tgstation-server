<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml">
<head>
<meta http-equiv="Content-Type" content="text/xhtml;charset=UTF-8"/>
<meta http-equiv="X-UA-Compatible" content="IE=9"/>
<meta name="generator" content="Doxygen 1.8.11"/>
<title>tgstation-server: README.md Source File</title>
<link href="tabs.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="jquery.js"></script>
<script type="text/javascript" src="dynsections.js"></script>
<link href="search/search.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="search/searchdata.js"></script>
<script type="text/javascript" src="search/search.js"></script>
<script type="text/javascript">
  $(document).ready(function() { init_search(); });
</script>
<link href="doxygen.css" rel="stylesheet" type="text/css" />
</head>
<body>
<div id="top"><!-- do not remove this div, it is closed by doxygen! -->
<div id="titlearea">
<table cellspacing="0" cellpadding="0">
 <tbody>
 <tr style="height: 56px;">
  <td id="projectlogo"><img alt="Logo" src="tgs.ico"/></td>
  <td id="projectalign" style="padding-left: 0.5em;">
   <div id="projectname">tgstation-server
   </div>
   <div id="projectbrief">The /tg/station 13 server suite</div>
  </td>
 </tr>
 </tbody>
</table>
</div>
<!-- end header part -->
<!-- Generated by Doxygen 1.8.11 -->
<script type="text/javascript">
var searchBox = new SearchBox("searchBox", "search",false,'Search');
</script>
  <div id="navrow1" class="tabs">
    <ul class="tablist">
      <li><a href="index.html"><span>Main&#160;Page</span></a></li>
      <li><a href="namespaces.html"><span>Packages</span></a></li>
      <li><a href="annotated.html"><span>Classes</span></a></li>
      <li class="current"><a href="files.html"><span>Files</span></a></li>
      <li>
        <div id="MSearchBox" class="MSearchBoxInactive">
        <span class="left">
          <img id="MSearchSelect" src="search/mag_sel.png"
               onmouseover="return searchBox.OnSearchSelectShow()"
               onmouseout="return searchBox.OnSearchSelectHide()"
               alt=""/>
          <input type="text" id="MSearchField" value="Search" accesskey="S"
               onfocus="searchBox.OnSearchFieldFocus(true)" 
               onblur="searchBox.OnSearchFieldFocus(false)" 
               onkeyup="searchBox.OnSearchFieldChange(event)"/>
          </span><span class="right">
            <a id="MSearchClose" href="javascript:searchBox.CloseResultsWindow()"><img id="MSearchCloseImg" border="0" src="search/close.png" alt=""/></a>
          </span>
        </div>
      </li>
    </ul>
  </div>
  <div id="navrow2" class="tabs2">
    <ul class="tablist">
      <li><a href="files.html"><span>File&#160;List</span></a></li>
      <li><a href="globals.html"><span>File&#160;Members</span></a></li>
    </ul>
  </div>
</div><!-- top -->
<!-- window showing the filter options -->
<div id="MSearchSelectWindow"
     onmouseover="return searchBox.OnSearchSelectShow()"
     onmouseout="return searchBox.OnSearchSelectHide()"
     onkeydown="return searchBox.OnSearchSelectKey(event)">
</div>

<!-- iframe showing the search results (closed by default) -->
<div id="MSearchResultsWindow">
<iframe src="javascript:void(0)" frameborder="0" 
        name="MSearchResults" id="MSearchResults">
</iframe>
</div>

<div class="header">
  <div class="headertitle">
<div class="title">README.md</div>  </div>
</div><!--header-->
<div class="contents">
<a href="_r_e_a_d_m_e_8md.html">Go to the documentation of this file.</a><div class="fragment"><div class="line"><a name="l00001"></a><span class="lineno">    1</span>&#160;# Tgstation Toolkit:</div><div class="line"><a name="l00002"></a><span class="lineno">    2</span>&#160;</div><div class="line"><a name="l00003"></a><span class="lineno">    3</span>&#160;[![Build status](https://ci.appveyor.com/api/projects/status/7t1h7bvuha0p9j5f/branch/master?svg=true)](https://ci.appveyor.com/project/Cyberboss/tgstation-server-tools/branch/master) [![Build Status](https://travis-ci.org/tgstation/tgstation-server.svg?branch=master)](https://travis-ci.org/tgstation/tgstation-server) [![codecov](https://codecov.io/gh/tgstation/tgstation-server/branch/master/graph/badge.svg)](https://codecov.io/gh/tgstation/tgstation-server) [![Waffle.io - Columns and their card count](https://badge.waffle.io/tgstation/tgstation-server.png?columns=all)](https://waffle.io/tgstation/tgstation-server?utm_source=badge)</div><div class="line"><a name="l00004"></a><span class="lineno">    4</span>&#160;</div><div class="line"><a name="l00005"></a><span class="lineno">    5</span>&#160;[![GitHub license](https://img.shields.io/github/license/tgstation/tgstation-server.svg)](https://github.com/tgstation/tgstation-server/blob/master/LICENSE) [![Average time to resolve an issue](http://isitmaintained.com/badge/resolution/tgstation/tgstation-server.svg)](http://isitmaintained.com/project/tgstation/tgstation-server &quot;Average time to resolve an issue&quot;) [![NuGet version](https://img.shields.io/nuget/v/TGServiceInterface.svg)](https://www.nuget.org/packages/TGServiceInterface)</div><div class="line"><a name="l00006"></a><span class="lineno">    6</span>&#160;</div><div class="line"><a name="l00007"></a><span class="lineno">    7</span>&#160;[![forthebadge](http://forthebadge.com/images/badges/made-with-c-sharp.svg)](http://forthebadge.com) [![forinfinityandbyond](https://user-images.githubusercontent.com/5211576/29499758-4efff304-85e6-11e7-8267-62919c3688a9.gif)](https://www.reddit.com/r/SS13/comments/5oplxp/what_is_the_main_problem_with_byond_as_an_engine/dclbu1a)</div><div class="line"><a name="l00008"></a><span class="lineno">    8</span>&#160;</div><div class="line"><a name="l00009"></a><span class="lineno">    9</span>&#160;[![forthebadge](http://forthebadge.com/images/badges/built-with-love.svg)](http://forthebadge.com) [![forthebadge](http://forthebadge.com/images/badges/60-percent-of-the-time-works-every-time.svg)](http://forthebadge.com)</div><div class="line"><a name="l00010"></a><span class="lineno">   10</span>&#160;</div><div class="line"><a name="l00011"></a><span class="lineno">   11</span>&#160;</div><div class="line"><a name="l00012"></a><span class="lineno">   12</span>&#160;This is a toolset to manage a production server of /tg/Station13 (and its forks). It includes the ability to update the server without having to stop or shutdown the server (the update will take effect next round) the ability start the server and restart it if it crashes, as well as systems for fixing errors and merging GitHub Pull Requests locally.</div><div class="line"><a name="l00013"></a><span class="lineno">   13</span>&#160;  </div><div class="line"><a name="l00014"></a><span class="lineno">   14</span>&#160;Generally, updates force a live tracking of the configured git repo, resetting local modifications. If you plan to make modifications, set up a new git repo to store your version of the code in, and point this script to that in the config (explained below). This can be on github or a local repo using file:/// urls.</div><div class="line"><a name="l00015"></a><span class="lineno">   15</span>&#160;</div><div class="line"><a name="l00016"></a><span class="lineno">   16</span>&#160;Requires python 2.7/3.6 to be installed for changelog generation</div><div class="line"><a name="l00017"></a><span class="lineno">   17</span>&#160;</div><div class="line"><a name="l00018"></a><span class="lineno">   18</span>&#160;### Legacy Server</div><div class="line"><a name="l00019"></a><span class="lineno">   19</span>&#160;* The old cmd script server can be found in the legacy tree</div><div class="line"><a name="l00020"></a><span class="lineno">   20</span>&#160;</div><div class="line"><a name="l00021"></a><span class="lineno">   21</span>&#160;</div><div class="line"><a name="l00022"></a><span class="lineno">   22</span>&#160;## Installing</div><div class="line"><a name="l00023"></a><span class="lineno">   23</span>&#160;1. Either compile from source (requires .NET Framework 4.5.2, Nuget, and WiX toolset 4.0) or download the latest [release from github](https://github.com/tgstation/tgstation-server-tools/releases)</div><div class="line"><a name="l00024"></a><span class="lineno">   24</span>&#160;1. Unzip setup files</div><div class="line"><a name="l00025"></a><span class="lineno">   25</span>&#160;1. Run the installer or use the console server</div><div class="line"><a name="l00026"></a><span class="lineno">   26</span>&#160;</div><div class="line"><a name="l00027"></a><span class="lineno">   27</span>&#160;## Installing (GUI):</div><div class="line"><a name="l00028"></a><span class="lineno">   28</span>&#160;1. Launch `TGControlPanel.exe` as an administrator. A shortcut can be found on your desktop</div><div class="line"><a name="l00029"></a><span class="lineno">   29</span>&#160;1. Use the `Create Instance` button to create a new server instance</div><div class="line"><a name="l00030"></a><span class="lineno">   30</span>&#160;1. Go to the `Repository` Tab and set the remote address and branch of the git you with to track</div><div class="line"><a name="l00031"></a><span class="lineno">   31</span>&#160;1. Hit the clone button</div><div class="line"><a name="l00032"></a><span class="lineno">   32</span>&#160;1. While waiting go to the `BYOND` tab and install the BYOND version you wish</div><div class="line"><a name="l00033"></a><span class="lineno">   33</span>&#160;1. You may also configure an IRC and/or discord bot for the server on the chat tab</div><div class="line"><a name="l00034"></a><span class="lineno">   34</span>&#160;1. Once the clone is complete you may set up a committer identity, user name, and password on the `Repository` tab for pushing changelog updates</div><div class="line"><a name="l00035"></a><span class="lineno">   35</span>&#160;1. Go to the `Server` tab and click the `Initialize Game Folders` button</div><div class="line"><a name="l00036"></a><span class="lineno">   36</span>&#160;1. Optionally change the `Project Path` Setting from tgstation to wherever the dme/dmb pair are in your repository</div><div class="line"><a name="l00037"></a><span class="lineno">   37</span>&#160;1. Optionally tick the Autostart box if you wish to have your server start with Windows</div><div class="line"><a name="l00038"></a><span class="lineno">   38</span>&#160;1. When game folder initialization is complete, click the `Copy from Repo and Compile` option</div><div class="line"><a name="l00039"></a><span class="lineno">   39</span>&#160;</div><div class="line"><a name="l00040"></a><span class="lineno">   40</span>&#160;## Installing (CL example):</div><div class="line"><a name="l00041"></a><span class="lineno">   41</span>&#160;This process is identical to the above steps in command line mode. You can always learn more about a command using `?` i.e. `repo ?`</div><div class="line"><a name="l00042"></a><span class="lineno">   42</span>&#160;1. Launch TGCommandLine.exe as an administrator (running with no parameters puts you in interactive mode)</div><div class="line"><a name="l00043"></a><span class="lineno">   43</span>&#160;1. `service set-python-path C:\Python27`</div><div class="line"><a name="l00044"></a><span class="lineno">   44</span>&#160;1. `service create-instance &quot;TGS&quot; D:\tgstation`</div><div class="line"><a name="l00045"></a><span class="lineno">   45</span>&#160;1. `instance` And enter `TGS`. If you aren&#39;t using interactive mode, the following commands must be suffixed with `--instance TGS`</div><div class="line"><a name="l00046"></a><span class="lineno">   46</span>&#160;1. `repo setup https://github.com/tgstation/tgstation master`</div><div class="line"><a name="l00047"></a><span class="lineno">   47</span>&#160;1. `byond update 511.1385`</div><div class="line"><a name="l00048"></a><span class="lineno">   48</span>&#160;1. `irc nick TGS3Test`</div><div class="line"><a name="l00049"></a><span class="lineno">   49</span>&#160;1. `irc set-auth-mode channel-mode`</div><div class="line"><a name="l00050"></a><span class="lineno">   50</span>&#160;1. `irc set-auth-level %`</div><div class="line"><a name="l00051"></a><span class="lineno">   51</span>&#160;1. `irc setup-auth NickServ &quot;id hunter2&quot;` Yes this is the real password, please use it only for testing</div><div class="line"><a name="l00052"></a><span class="lineno">   52</span>&#160;1. `irc join botbus dev`</div><div class="line"><a name="l00053"></a><span class="lineno">   53</span>&#160;1. `irc join botbus admin`</div><div class="line"><a name="l00054"></a><span class="lineno">   54</span>&#160;1. `irc join botbus wd`</div><div class="line"><a name="l00055"></a><span class="lineno">   55</span>&#160;1. `irc join botbus game`</div><div class="line"><a name="l00056"></a><span class="lineno">   56</span>&#160;1. `irc enable`</div><div class="line"><a name="l00057"></a><span class="lineno">   57</span>&#160;1. `discord set-token Rjfa93jlksjfj934jlkjasf8a08wfl.asdjfj08e44` See https://discordapp.com/developers/docs/topics/oauth2#bots</div><div class="line"><a name="l00058"></a><span class="lineno">   58</span>&#160;1. `discord set-auth-mode role-id`</div><div class="line"><a name="l00059"></a><span class="lineno">   59</span>&#160;1. `discord addmin 192837419273409` See how to get a role id: https://www.reddit.com/r/discordapp/comments/5bezg2/role_id/. Note that if you `discord set-auth-mode user-id` you&#39;ll need to use user ids (Enable developer mode, right click user, `Copy ID`)</div><div class="line"><a name="l00060"></a><span class="lineno">   60</span>&#160;1. `discord join 12341234453235 dev` This is a channel id (Enable developer mode, right click channel, `Copy ID`)</div><div class="line"><a name="l00061"></a><span class="lineno">   61</span>&#160;1. `discord join 34563456344245 dev`</div><div class="line"><a name="l00062"></a><span class="lineno">   62</span>&#160;1. `discord join 23452362574456 admin`</div><div class="line"><a name="l00063"></a><span class="lineno">   63</span>&#160;1. `discord join 23452362574456 wd`</div><div class="line"><a name="l00064"></a><span class="lineno">   64</span>&#160;1. `discord join 53457345736788 game`</div><div class="line"><a name="l00065"></a><span class="lineno">   65</span>&#160;1. `discord enable`</div><div class="line"><a name="l00066"></a><span class="lineno">   66</span>&#160;1. `repo set-name tgstation-server` These two lines specify the changelog&#39;s committer identity. They are not mirrored in the GUI</div><div class="line"><a name="l00067"></a><span class="lineno">   67</span>&#160;1. `repo set-email tgstation-server@tgstation13.org`</div><div class="line"><a name="l00068"></a><span class="lineno">   68</span>&#160;1. `repo set-credentials` And follow the prompts</div><div class="line"><a name="l00069"></a><span class="lineno">   69</span>&#160;1. `dm project-name tgstation`</div><div class="line"><a name="l00070"></a><span class="lineno">   70</span>&#160;1. `dd autostart on`</div><div class="line"><a name="l00071"></a><span class="lineno">   71</span>&#160;1. `repo status` To check the clone job status</div><div class="line"><a name="l00072"></a><span class="lineno">   72</span>&#160;1. `dm initialize --wait`</div><div class="line"><a name="l00073"></a><span class="lineno">   73</span>&#160;1. `dd start`</div><div class="line"><a name="l00074"></a><span class="lineno">   74</span>&#160;</div><div class="line"><a name="l00075"></a><span class="lineno">   75</span>&#160;## Setting up Multi-User</div><div class="line"><a name="l00076"></a><span class="lineno">   76</span>&#160;</div><div class="line"><a name="l00077"></a><span class="lineno">   77</span>&#160;1. Create windows accounts for those you wish to have access to the service</div><div class="line"><a name="l00078"></a><span class="lineno">   78</span>&#160;1. Join them in a common windows group</div><div class="line"><a name="l00079"></a><span class="lineno">   79</span>&#160;1. Run TGCommandLine.exe as an administrator</div><div class="line"><a name="l00080"></a><span class="lineno">   80</span>&#160;1. `admin set-group &lt;Name of the group you created&gt; --instance &quot;&lt;instance name&gt;&quot;`</div><div class="line"><a name="l00081"></a><span class="lineno">   81</span>&#160;</div><div class="line"><a name="l00082"></a><span class="lineno">   82</span>&#160;Note: Due to internal functionality, a user who has access to at least one server instance will be able to view the metadata (Name, path, Logging ID, and Enabled status) of all instances.</div><div class="line"><a name="l00083"></a><span class="lineno">   83</span>&#160;</div><div class="line"><a name="l00084"></a><span class="lineno">   84</span>&#160;## Setting up Remote access</div><div class="line"><a name="l00085"></a><span class="lineno">   85</span>&#160;</div><div class="line"><a name="l00086"></a><span class="lineno">   86</span>&#160;1. Obtain an SSL certificate to secure the connection (this is beyond the scope of this guide)</div><div class="line"><a name="l00087"></a><span class="lineno">   87</span>&#160;1. Either stick with the default port `38607` or change it with `admin set-port &lt;port #&gt;`</div><div class="line"><a name="l00088"></a><span class="lineno">   88</span>&#160;1. [Bind the SSL certificate to the port](https://docs.microsoft.com/en-us/dotnet/framework/wcf/feature-details/how-to-configure-a-port-with-an-ssl-certificate)</div><div class="line"><a name="l00089"></a><span class="lineno">   89</span>&#160;   - e.g. `netsh http add sslcert ipport=0.0.0.0:&lt;port #&gt; certhash=&lt;certificate hash&gt; appid={F32EDA25-0855-411C-AF5E-F0D042917E2D}`</div><div class="line"><a name="l00090"></a><span class="lineno">   90</span>&#160;   - The `appid` GUID actually doesn&#39;t matter, but for sanity, you should use the GUID of TGServerService.exe as printed above</div><div class="line"><a name="l00091"></a><span class="lineno">   91</span>&#160;   - Power shell users remember to quit the appid: `netsh http add sslcert ipport=0.0.0.0:&lt;port #&gt; certhash=&lt;certificate hash&gt; appid=&quot;{F32EDA25-0855-411C-AF5E-F0D042917E2D}&quot;` as {} has special meaning in powershell</div><div class="line"><a name="l00092"></a><span class="lineno">   92</span>&#160;1. Ensure the port can be acccessed from the internet</div><div class="line"><a name="l00093"></a><span class="lineno">   93</span>&#160;1. Log in from any computer using a username and password from the service computer in either the CLI or GUI</div><div class="line"><a name="l00094"></a><span class="lineno">   94</span>&#160;</div><div class="line"><a name="l00095"></a><span class="lineno">   95</span>&#160;## Updating</div><div class="line"><a name="l00096"></a><span class="lineno">   96</span>&#160;</div><div class="line"><a name="l00097"></a><span class="lineno">   97</span>&#160;The service supports updates while running a DreamDaemon instance. Simply install an updated version as you normally would and process ownership will transfer smoothly to the new service.</div><div class="line"><a name="l00098"></a><span class="lineno">   98</span>&#160;</div><div class="line"><a name="l00099"></a><span class="lineno">   99</span>&#160;### Folders and Files (None of these should be touched):</div><div class="line"><a name="l00100"></a><span class="lineno">  100</span>&#160;* `Game/&lt;A/B&gt;/`</div><div class="line"><a name="l00101"></a><span class="lineno">  101</span>&#160;   * This will house two copies of the game code, one for updating and one for live. When updating, it will automatically swap them.</div><div class="line"><a name="l00102"></a><span class="lineno">  102</span>&#160;</div><div class="line"><a name="l00103"></a><span class="lineno">  103</span>&#160;* `Static/`</div><div class="line"><a name="l00104"></a><span class="lineno">  104</span>&#160;   * This contains the `data/` and `config/` folders from the code. They are stored here and a symbolic link is created in the `Game` folders pointing to here.</div><div class="line"><a name="l00105"></a><span class="lineno">  105</span>&#160;   * Resetting the repository will create a backup of this and reinitalize it</div><div class="line"><a name="l00106"></a><span class="lineno">  106</span>&#160;</div><div class="line"><a name="l00107"></a><span class="lineno">  107</span>&#160;* `Game/Live/`</div><div class="line"><a name="l00108"></a><span class="lineno">  108</span>&#160;   * This is a symbolic link pointing to current &quot;live&quot; folder.</div><div class="line"><a name="l00109"></a><span class="lineno">  109</span>&#160;   * When the server is updated, we just point this to the updating folder so that the update takes place next round.</div><div class="line"><a name="l00110"></a><span class="lineno">  110</span>&#160;</div><div class="line"><a name="l00111"></a><span class="lineno">  111</span>&#160;* `Diagnostics`</div><div class="line"><a name="l00112"></a><span class="lineno">  112</span>&#160;   * This contains various timestamped diagnostic information for DreamDaemon invocations</div><div class="line"><a name="l00113"></a><span class="lineno">  113</span>&#160;</div><div class="line"><a name="l00114"></a><span class="lineno">  114</span>&#160;* `Repository/`</div><div class="line"><a name="l00115"></a><span class="lineno">  115</span>&#160;   * This contains the actual git repository, all changes in here will be overwritten during update operations.</div><div class="line"><a name="l00116"></a><span class="lineno">  116</span>&#160;</div><div class="line"><a name="l00117"></a><span class="lineno">  117</span>&#160;* `RepoKey/`</div><div class="line"><a name="l00118"></a><span class="lineno">  118</span>&#160;   * This contains ssh key information for automatic changelog pushing. </div><div class="line"><a name="l00119"></a><span class="lineno">  119</span>&#160;</div><div class="line"><a name="l00120"></a><span class="lineno">  120</span>&#160;* `EventHandlers/`</div><div class="line"><a name="l00121"></a><span class="lineno">  121</span>&#160;   * This contains batch files that run after certain events, currently only precompile and postcompile events are implemented. If you&#39;d like an event handler you should create a file in this folder with the following name: `{event_name}.bat` for example: if I want an event handler for precompile, I would name it `precompile.bat`.</div><div class="line"><a name="l00122"></a><span class="lineno">  122</span>&#160;</div><div class="line"><a name="l00123"></a><span class="lineno">  123</span>&#160;* `BYOND/`</div><div class="line"><a name="l00124"></a><span class="lineno">  124</span>&#160;   * This contains the actual BYOND installation the server uses</div><div class="line"><a name="l00125"></a><span class="lineno">  125</span>&#160;</div><div class="line"><a name="l00126"></a><span class="lineno">  126</span>&#160;* `BYOND_staging/`</div><div class="line"><a name="l00127"></a><span class="lineno">  127</span>&#160;   * This appears when a BYOND update is queued but can&#39;t currently be applied due to usage of the current BYOND version. It will be applied at the first possible moment. Restarting the service deletes this folder</div><div class="line"><a name="l00128"></a><span class="lineno">  128</span>&#160;</div><div class="line"><a name="l00129"></a><span class="lineno">  129</span>&#160;* `BYOND_revision.zip`</div><div class="line"><a name="l00130"></a><span class="lineno">  130</span>&#160;   * This is a queued update downloaded from BYOND, it will be unzipped into BYOND_staging and deleted. Restarting the service deletes this file</div><div class="line"><a name="l00131"></a><span class="lineno">  131</span>&#160;</div><div class="line"><a name="l00132"></a><span class="lineno">  132</span>&#160;* `TGDreamDaemonBridge.dll`</div><div class="line"><a name="l00133"></a><span class="lineno">  133</span>&#160;   * This is the .dll the TGS3 API `call()()`s into to RPC the server instance that runs it</div><div class="line"><a name="l00134"></a><span class="lineno">  134</span>&#160;   * Instance -&gt; DreamDaemon communication is achieved via `world/Topic()`</div><div class="line"><a name="l00135"></a><span class="lineno">  135</span>&#160;</div><div class="line"><a name="l00136"></a><span class="lineno">  136</span>&#160;* `prtestjob.json`</div><div class="line"><a name="l00137"></a><span class="lineno">  137</span>&#160;   * This contains information about current test merged pull requests in the Repository folder</div><div class="line"><a name="l00138"></a><span class="lineno">  138</span>&#160;   </div><div class="line"><a name="l00139"></a><span class="lineno">  139</span>&#160;* `TGS3.json`</div><div class="line"><a name="l00140"></a><span class="lineno">  140</span>&#160;   * This is a copy of `TGS3.json` from the Repository. If a repostory change creates differences between the two, update operations will be blocked until the user confirms they want to change it</div><div class="line"><a name="l00141"></a><span class="lineno">  141</span>&#160;</div><div class="line"><a name="l00142"></a><span class="lineno">  142</span>&#160;* `Instance.json`</div><div class="line"><a name="l00143"></a><span class="lineno">  143</span>&#160;   * The internal configuration settings for a server instance. Note that access to this file bypasses API user restrictions</div><div class="line"><a name="l00144"></a><span class="lineno">  144</span>&#160;</div><div class="line"><a name="l00145"></a><span class="lineno">  145</span>&#160;### Codebase integration</div><div class="line"><a name="l00146"></a><span class="lineno">  146</span>&#160;To get the TGS3 API for your code base, import the 3 .dm files in the `DMAPI` folder into your include structure, then fill out the configuration as documented in the comments of server_tools.dm. Then, you may want to add a `TGS3.json` file to specify any static directories and .dlls your codebase uses, along with the optional changelog compile options. Any changes to `TGS3.json` will block compiler operations until a server operator manually approves them.</div><div class="line"><a name="l00147"></a><span class="lineno">  147</span>&#160;</div><div class="line"><a name="l00148"></a><span class="lineno">  148</span>&#160;### Starting the game server:</div><div class="line"><a name="l00149"></a><span class="lineno">  149</span>&#160;To run the game server, open the `Server` tab of the control panel and click either `Start`</div><div class="line"><a name="l00150"></a><span class="lineno">  150</span>&#160;</div><div class="line"><a name="l00151"></a><span class="lineno">  151</span>&#160;It will restart the game server if it shutdowns for any reason, giving up after 5 tries in under a minute</div><div class="line"><a name="l00152"></a><span class="lineno">  152</span>&#160;</div><div class="line"><a name="l00153"></a><span class="lineno">  153</span>&#160;### Updating the server:</div><div class="line"><a name="l00154"></a><span class="lineno">  154</span>&#160;To update the server, open the `Server` tab of the control panel. Click `Update Server`. (it will git pull, compile, all that jazz). Note that this button won&#39;t clear test merges.  </div><div class="line"><a name="l00155"></a><span class="lineno">  155</span>&#160;</div><div class="line"><a name="l00156"></a><span class="lineno">  156</span>&#160;(Note: Updating automatically does a code reset, clearing ALL changes to the local git repo, including manual changes (This will not change any data in the `Static/` folder))  </div><div class="line"><a name="l00157"></a><span class="lineno">  157</span>&#160;</div><div class="line"><a name="l00158"></a><span class="lineno">  158</span>&#160;Updates do not require the server to be shutdown, changes will apply next round if the server is currently running.  </div><div class="line"><a name="l00159"></a><span class="lineno">  159</span>&#160;</div><div class="line"><a name="l00160"></a><span class="lineno">  160</span>&#160;All DM compilation will log to the server what commit they happened at and create a backup tag in the local repository.</div><div class="line"><a name="l00161"></a><span class="lineno">  161</span>&#160;</div><div class="line"><a name="l00162"></a><span class="lineno">  162</span>&#160;### Locally merge GitHub Pull Requests (PR test merge):</div><div class="line"><a name="l00163"></a><span class="lineno">  163</span>&#160;This feature currently only works if github is the remote (git server).</div><div class="line"><a name="l00164"></a><span class="lineno">  164</span>&#160;</div><div class="line"><a name="l00165"></a><span class="lineno">  165</span>&#160;Running these will merge the pull request then recompile the server, changes take effect the next round if the server is currently running.  </div><div class="line"><a name="l00166"></a><span class="lineno">  166</span>&#160;</div><div class="line"><a name="l00167"></a><span class="lineno">  167</span>&#160;There are two flavors to this.</div><div class="line"><a name="l00168"></a><span class="lineno">  168</span>&#160;* The manual method is to use the repo page&#39;s merge PR button for fine grain control over PR merging. Each time this button is pressed, the latest commit of the specified PR# will be merged into the repo</div><div class="line"><a name="l00169"></a><span class="lineno">  169</span>&#160;* The managed method is the Server page&#39;s `Test Merge Manager` which uses the GitHub API to get information about available PRs.</div><div class="line"><a name="l00170"></a><span class="lineno">  170</span>&#160;   * Open PRs are listed by default</div><div class="line"><a name="l00171"></a><span class="lineno">  171</span>&#160;   * Currently test merged PRs are checked off and listed at the top when it&#39;s opened</div><div class="line"><a name="l00172"></a><span class="lineno">  172</span>&#160;* If a PR contains a label that contains the text `test` (case-insensitive) it will be listed on top and marked as `TESTING REQUESTED`</div><div class="line"><a name="l00173"></a><span class="lineno">  173</span>&#160;   * If a PR has been updated since it was test merged, two entries for it will appear. One listed as `OUTDATED` and specifying the commit it was merged at</div><div class="line"><a name="l00174"></a><span class="lineno">  174</span>&#160;   * You can change the initial update action of the server with the radio buttons in the bottom left. `Update to Remote` fully resets and updates the server before merging PRs. `Update To Origin` does the same based off the local repository&#39;s `origin` remote. `No Update` will merge the PRs without any prior action</div><div class="line"><a name="l00175"></a><span class="lineno">  175</span>&#160;   * Checking off PRs here and then hitting apply will run the selected update action, optionally generate and push a changelog (see below), merge the PRs, and then compile. `Update Server` will keep any active merged PRs until they are manually removed or merged on the `origin` remote.</div><div class="line"><a name="l00176"></a><span class="lineno">  176</span>&#160;   * Given that the control panel uses GitHub&#39;s API to populate the `Test Merge Manager` you may be prompted for your credentials if you make too many requests. This will create a personal access token with public access on your account specifying its use to bypass the GitHub API rate limit.</div><div class="line"><a name="l00177"></a><span class="lineno">  177</span>&#160;</div><div class="line"><a name="l00178"></a><span class="lineno">  178</span>&#160;You can clear all active test merges using `Reset to Origin Branch` in the `Repository` tab and the using `Copy from Repo and Compile` in the server tab (explained below). You can also use the `Reset All Test Merges` button on the server tab for a concise solution.</div><div class="line"><a name="l00179"></a><span class="lineno">  179</span>&#160;</div><div class="line"><a name="l00180"></a><span class="lineno">  180</span>&#160;### The Compiler</div><div class="line"><a name="l00181"></a><span class="lineno">  181</span>&#160;* `Server` -&gt; `Copy from Repo and Compile`</div><div class="line"><a name="l00182"></a><span class="lineno">  182</span>&#160;   * Copies the local repository code, compiles it, and stages it to apply next round</div><div class="line"><a name="l00183"></a><span class="lineno">  183</span>&#160;* `Server` -&gt; `Initialize Game Folders`</div><div class="line"><a name="l00184"></a><span class="lineno">  184</span>&#160;   * Requires the server not be running, rebuilds the `Game` folder and then does `Copy from Repo and Compile`</div><div class="line"><a name="l00185"></a><span class="lineno">  185</span>&#160;   * Required on first setup</div><div class="line"><a name="l00186"></a><span class="lineno">  186</span>&#160; </div><div class="line"><a name="l00187"></a><span class="lineno">  187</span>&#160;### Starting everything when the computer/server boots</div><div class="line"><a name="l00188"></a><span class="lineno">  188</span>&#160;Just tick the `Autostart` option in the `Server` tab or run `dd autostart on` on the command line. As it&#39;s a windows service, it will automatically run without having to log ing</div><div class="line"><a name="l00189"></a><span class="lineno">  189</span>&#160;</div><div class="line"><a name="l00190"></a><span class="lineno">  190</span>&#160;### Enabling the BYOND Webclient</div><div class="line"><a name="l00191"></a><span class="lineno">  191</span>&#160;Just tick the `Webclient` option in the `Server` tab or run `dd webclient on` on the command line.</div><div class="line"><a name="l00192"></a><span class="lineno">  192</span>&#160;</div><div class="line"><a name="l00193"></a><span class="lineno">  193</span>&#160;### Static Configuration</div><div class="line"><a name="l00194"></a><span class="lineno">  194</span>&#160;* The `Static Files` page of the control panel lets you modify all files in directories you specified in `TGS3.json`</div><div class="line"><a name="l00195"></a><span class="lineno">  195</span>&#160;* The files are modified here using the Windows credentials of the active user, feel free to manually set ACLs on them</div><div class="line"><a name="l00196"></a><span class="lineno">  196</span>&#160;* You may optionally rebuild the entire `Static` folder from the repository using the `Recreate Static Directory` button. This will copy the original files from the repository based on the current `TGS3.json`. This requires DreamDaemon not be running</div><div class="line"><a name="l00197"></a><span class="lineno">  197</span>&#160;</div><div class="line"><a name="l00198"></a><span class="lineno">  198</span>&#160;### Modifying Your Code</div><div class="line"><a name="l00199"></a><span class="lineno">  199</span>&#160;</div><div class="line"><a name="l00200"></a><span class="lineno">  200</span>&#160;Any `.dm` files included in the root level of the `Static` directory are automatically copied over and included before anything else in your `.dme` for compilation. Use this to configure compile options as you see fit.</div><div class="line"><a name="l00201"></a><span class="lineno">  201</span>&#160;</div><div class="line"><a name="l00202"></a><span class="lineno">  202</span>&#160;### Moving, Renaming, and Detaching instances</div><div class="line"><a name="l00203"></a><span class="lineno">  203</span>&#160;</div><div class="line"><a name="l00204"></a><span class="lineno">  204</span>&#160;* Instances can be renamed, but this requires a temporary offlining of them (this includes interface access, DreamDaemon, and chat bots)</div><div class="line"><a name="l00205"></a><span class="lineno">  205</span>&#160;* Detaching an instance simply removes it from the main server&#39;s configuration and control, leaving it free for the user to manipulate</div><div class="line"><a name="l00206"></a><span class="lineno">  206</span>&#160;* Importing an instance will work as long as</div><div class="line"><a name="l00207"></a><span class="lineno">  207</span>&#160;   1. No other instance currently in the server has the same name</div><div class="line"><a name="l00208"></a><span class="lineno">  208</span>&#160;   1. It is not the same path as another instance</div><div class="line"><a name="l00209"></a><span class="lineno">  209</span>&#160;   Note that importing an instance as a different windows user (this is always different across machines) will result in a loss of chat configuration due to the encryption scheme</div><div class="line"><a name="l00210"></a><span class="lineno">  210</span>&#160;</div><div class="line"><a name="l00211"></a><span class="lineno">  211</span>&#160;### Viewing Server Logs</div><div class="line"><a name="l00212"></a><span class="lineno">  212</span>&#160;* Service logs are stored in the Windows event viewer under `Windows Logs` -&gt; `Application`. You&#39;ll need to filter this list for `TG Station Server`</div><div class="line"><a name="l00213"></a><span class="lineno">  213</span>&#160;* Every event type is keyed with an ID. A complete listing of these IDs and their purpose can be found [here](https://github.com/tgstation/tgstation-server/blob/master/TGS.Server/EventID.cs). Event IDs from different instances are offset by the logging ID the instance was assigned when it was started.</div><div class="line"><a name="l00214"></a><span class="lineno">  214</span>&#160;* You can also import the custom view `View TGS3 Logs.xml` in this folder to have them automatically filtered</div><div class="line"><a name="l00215"></a><span class="lineno">  215</span>&#160;* Servers running in console mode only use std_out</div><div class="line"><a name="l00216"></a><span class="lineno">  216</span>&#160;</div><div class="line"><a name="l00217"></a><span class="lineno">  217</span>&#160;### Enabling upstream changelog generation</div><div class="line"><a name="l00218"></a><span class="lineno">  218</span>&#160;* The repository will automatically create an ssh version of the initial origin remote and can optionally push generated changelogs to your git through it</div><div class="line"><a name="l00219"></a><span class="lineno">  219</span>&#160;* The repository can only authenticate using ssh public key authentication</div><div class="line"><a name="l00220"></a><span class="lineno">  220</span>&#160;* To enable this feature, simply create `public_key.txt` and `private_key.txt` in a folder called RepoKey in the server directory</div><div class="line"><a name="l00221"></a><span class="lineno">  221</span>&#160;* The private key must be in `-----BEGIN RSA PRIVATE KEY-----` format and the public key must be in `ssh-rsa` format. You can generate a keypair like this using the converter in the dropdown menu of PuTTYGen. See github guidelines for setting this up here: https://help.github.com/articles/connecting-to-github-with-ssh/</div><div class="line"><a name="l00222"></a><span class="lineno">  222</span>&#160;* The server will be able to read these files regardless of their permissions, so the responsibility is on you to set their ACL&#39;s so they can&#39;t be read by those that shouldn&#39;t</div><div class="line"><a name="l00223"></a><span class="lineno">  223</span>&#160;</div><div class="line"><a name="l00224"></a><span class="lineno">  224</span>&#160;### Synchronized test merge commits</div><div class="line"><a name="l00225"></a><span class="lineno">  225</span>&#160;* An instance can push branchless test merge commits to GitHub if the `RepoKey` folder is setup</div><div class="line"><a name="l00226"></a><span class="lineno">  226</span>&#160;* This pushes all test merge commits to the remote branch `___TGS3TempBranch` and then deletes it</div><div class="line"><a name="l00227"></a><span class="lineno">  227</span>&#160;* This provides public reference information about the test merge commit and time since it will appear in the PR in questing</div><div class="line"><a name="l00228"></a><span class="lineno">  228</span>&#160;* To enable this, check the `Sync Commits` button on the `Repository` page of the control panel or run `repo push-testmerges on --instance &quot;&lt;instance name&gt;&quot;` from TGCommandLine</div><div class="line"><a name="l00229"></a><span class="lineno">  229</span>&#160;</div><div class="line"><a name="l00230"></a><span class="lineno">  230</span>&#160;## CONTRIBUTING</div><div class="line"><a name="l00231"></a><span class="lineno">  231</span>&#160;</div><div class="line"><a name="l00232"></a><span class="lineno">  232</span>&#160;* See [CONTRIBUTING.md](https://github.com/tgstation/tgstation-server/blob/master/.github/CONTRIBUTING.md)</div><div class="line"><a name="l00233"></a><span class="lineno">  233</span>&#160;</div><div class="line"><a name="l00234"></a><span class="lineno">  234</span>&#160;## LICENSING</div><div class="line"><a name="l00235"></a><span class="lineno">  235</span>&#160;</div><div class="line"><a name="l00236"></a><span class="lineno">  236</span>&#160;* The DM API for the project is licensed under the MIT license.</div><div class="line"><a name="l00237"></a><span class="lineno">  237</span>&#160;* The /tg/station 13 icon is licensed under [Creative Commons 3.0 BY-SA](http://creativecommons.org/licenses/by-sa/3.0/).</div><div class="line"><a name="l00238"></a><span class="lineno">  238</span>&#160;* The remainder of the project is licensed under [GNU AGPL v3](http://www.gnu.org/licenses/agpl-3.0.html)</div><div class="line"><a name="l00239"></a><span class="lineno">  239</span>&#160;</div><div class="line"><a name="l00240"></a><span class="lineno">  240</span>&#160;See the bottom of each file in the /DMAPI tree for the MIT license</div></div><!-- fragment --></div><!-- contents -->
<!-- start footer part -->
<hr class="footer"/><address class="footer"><small>
Generated by &#160;<a href="http://www.doxygen.org/index.html">
<img class="footer" src="doxygen.png" alt="doxygen"/>
</a> 1.8.11
</small></address>
</body>
</html>
