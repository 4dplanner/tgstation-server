<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml">
<head>
<meta http-equiv="Content-Type" content="text/xhtml;charset=UTF-8"/>
<meta http-equiv="X-UA-Compatible" content="IE=9"/>
<meta name="generator" content="Doxygen 1.8.11"/>
<title>tgstation-server: TGS.Server.Service/Service.cs Source File</title>
<link href="tabs.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="jquery.js"></script>
<script type="text/javascript" src="dynsections.js"></script>
<link href="search/search.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="search/searchdata.js"></script>
<script type="text/javascript" src="search/search.js"></script>
<script type="text/javascript">
  $(document).ready(function() { init_search(); });
</script>
<link href="doxygen.css" rel="stylesheet" type="text/css" />
</head>
<body>
<div id="top"><!-- do not remove this div, it is closed by doxygen! -->
<div id="titlearea">
<table cellspacing="0" cellpadding="0">
 <tbody>
 <tr style="height: 56px;">
  <td id="projectlogo"><img alt="Logo" src="tgs.ico"/></td>
  <td id="projectalign" style="padding-left: 0.5em;">
   <div id="projectname">tgstation-server
   </div>
   <div id="projectbrief">The /tg/station 13 server suite</div>
  </td>
 </tr>
 </tbody>
</table>
</div>
<!-- end header part -->
<!-- Generated by Doxygen 1.8.11 -->
<script type="text/javascript">
var searchBox = new SearchBox("searchBox", "search",false,'Search');
</script>
  <div id="navrow1" class="tabs">
    <ul class="tablist">
      <li><a href="index.html"><span>Main&#160;Page</span></a></li>
      <li><a href="namespaces.html"><span>Packages</span></a></li>
      <li><a href="annotated.html"><span>Classes</span></a></li>
      <li class="current"><a href="files.html"><span>Files</span></a></li>
      <li>
        <div id="MSearchBox" class="MSearchBoxInactive">
        <span class="left">
          <img id="MSearchSelect" src="search/mag_sel.png"
               onmouseover="return searchBox.OnSearchSelectShow()"
               onmouseout="return searchBox.OnSearchSelectHide()"
               alt=""/>
          <input type="text" id="MSearchField" value="Search" accesskey="S"
               onfocus="searchBox.OnSearchFieldFocus(true)" 
               onblur="searchBox.OnSearchFieldFocus(false)" 
               onkeyup="searchBox.OnSearchFieldChange(event)"/>
          </span><span class="right">
            <a id="MSearchClose" href="javascript:searchBox.CloseResultsWindow()"><img id="MSearchCloseImg" border="0" src="search/close.png" alt=""/></a>
          </span>
        </div>
      </li>
    </ul>
  </div>
  <div id="navrow2" class="tabs2">
    <ul class="tablist">
      <li><a href="files.html"><span>File&#160;List</span></a></li>
      <li><a href="globals.html"><span>File&#160;Members</span></a></li>
    </ul>
  </div>
<!-- window showing the filter options -->
<div id="MSearchSelectWindow"
     onmouseover="return searchBox.OnSearchSelectShow()"
     onmouseout="return searchBox.OnSearchSelectHide()"
     onkeydown="return searchBox.OnSearchSelectKey(event)">
</div>

<!-- iframe showing the search results (closed by default) -->
<div id="MSearchResultsWindow">
<iframe src="javascript:void(0)" frameborder="0" 
        name="MSearchResults" id="MSearchResults">
</iframe>
</div>

<div id="nav-path" class="navpath">
  <ul>
<li class="navelem"><a class="el" href="dir_bd949ea21e8dee4d3ffa1e26374ba5e6.html">TGS.Server.Service</a></li>  </ul>
</div>
</div><!-- top -->
<div class="header">
  <div class="headertitle">
<div class="title">Service.cs</div>  </div>
</div><!--header-->
<div class="contents">
<a href="_t_g_s_8_server_8_service_2_service_8cs.html">Go to the documentation of this file.</a><div class="fragment"><div class="line"><a name="l00001"></a><span class="lineno">    1</span>&#160;<span class="keyword">using</span> <a class="code" href="_t_g_s_8_command_line_2_program_8cs.html#a81a223a02c34d82b47199f08308847f2">System</a>;</div><div class="line"><a name="l00002"></a><span class="lineno">    2</span>&#160;<span class="keyword">using</span> <a class="code" href="namespace_system.html">System</a>.Diagnostics;</div><div class="line"><a name="l00003"></a><span class="lineno">    3</span>&#160;<span class="keyword">using</span> <a class="code" href="namespace_system.html">System</a>.ServiceProcess;</div><div class="line"><a name="l00004"></a><span class="lineno">    4</span>&#160;</div><div class="line"><a name="l00005"></a><span class="lineno">    5</span>&#160;<span class="keyword">namespace </span><a class="code" href="namespace_t_g_s.html">TGS</a>.Server.Service</div><div class="line"><a name="l00006"></a><span class="lineno">    6</span>&#160;{</div><div class="line"><a name="l00010"></a><span class="lineno"><a class="line" href="class_t_g_s_1_1_server_1_1_service_1_1_service.html">   10</a></span>&#160;    <span class="keyword">public</span> sealed <span class="keyword">class </span><a class="code" href="class_t_g_s_1_1_server_1_1_service_1_1_service.html">Service</a> : <a class="code" href="class_service_base.html">ServiceBase</a>, <a class="code" href="interface_t_g_s_1_1_server_1_1_i_logger.html">ILogger</a></div><div class="line"><a name="l00011"></a><span class="lineno">   11</span>&#160;    {</div><div class="line"><a name="l00015"></a><span class="lineno">   15</span>&#160;        <span class="keyword">public</span> <span class="keyword">static</span> <span class="keywordtype">void</span> Main() =&gt; Run(<span class="keyword">new</span> <a class="code" href="class_t_g_s_1_1_server_1_1_service_1_1_service.html">Service</a>());</div><div class="line"><a name="l00016"></a><span class="lineno">   16</span>&#160;</div><div class="line"><a name="l00020"></a><span class="lineno"><a class="line" href="class_t_g_s_1_1_server_1_1_service_1_1_service.html#ab5fec892fdcf64809d41d6d7483659e6">   20</a></span>&#160;        <a class="code" href="class_t_g_s_1_1_server_1_1_server.html">Server</a> <a class="code" href="class_t_g_s_1_1_server_1_1_service_1_1_service.html#ab5fec892fdcf64809d41d6d7483659e6">activeServer</a>;</div><div class="line"><a name="l00021"></a><span class="lineno">   21</span>&#160;</div><div class="line"><a name="l00025"></a><span class="lineno"><a class="line" href="class_t_g_s_1_1_server_1_1_service_1_1_service.html#ac6439b90f7bec025e8a71849b5174710">   25</a></span>&#160;        <a class="code" href="class_t_g_s_1_1_server_1_1_service_1_1_service.html#ac6439b90f7bec025e8a71849b5174710">Service</a>()</div><div class="line"><a name="l00026"></a><span class="lineno">   26</span>&#160;        {</div><div class="line"><a name="l00027"></a><span class="lineno">   27</span>&#160;            ServiceName = <span class="stringliteral">&quot;TG Station Server&quot;</span>;</div><div class="line"><a name="l00028"></a><span class="lineno">   28</span>&#160;        }</div><div class="line"><a name="l00029"></a><span class="lineno">   29</span>&#160;</div><div class="line"><a name="l00031"></a><span class="lineno"><a class="line" href="class_t_g_s_1_1_server_1_1_service_1_1_service.html#a00360dc1c721296437f17214fdd405df">   31</a></span>&#160;        <span class="keyword">public</span> <span class="keywordtype">void</span> <a class="code" href="class_t_g_s_1_1_server_1_1_service_1_1_service.html#a00360dc1c721296437f17214fdd405df">WriteAccess</a>(<span class="keywordtype">string</span> username, <span class="keywordtype">bool</span> authSuccess, byte loggingID)</div><div class="line"><a name="l00032"></a><span class="lineno">   32</span>&#160;        {</div><div class="line"><a name="l00033"></a><span class="lineno">   33</span>&#160;            EventLog.WriteEntry(String.Format(<span class="stringliteral">&quot;Access from: {0}&quot;</span>, username), authSuccess ? EventLogEntryType.SuccessAudit : EventLogEntryType.FailureAudit , (int)<a class="code" href="namespace_t_g_s_1_1_server.html#a4682739b9567dc9e4e5c327c253ce311">EventID</a>.Authentication + loggingID);</div><div class="line"><a name="l00034"></a><span class="lineno">   34</span>&#160;        }</div><div class="line"><a name="l00035"></a><span class="lineno">   35</span>&#160;</div><div class="line"><a name="l00037"></a><span class="lineno"><a class="line" href="class_t_g_s_1_1_server_1_1_service_1_1_service.html#a00104d3e06744d907e963ebf4472cb5d">   37</a></span>&#160;        <span class="keyword">public</span> <span class="keywordtype">void</span> <a class="code" href="class_t_g_s_1_1_server_1_1_service_1_1_service.html#a00104d3e06744d907e963ebf4472cb5d">WriteError</a>(<span class="keywordtype">string</span> message, <a class="code" href="namespace_t_g_s_1_1_server.html#a4682739b9567dc9e4e5c327c253ce311">EventID</a> <span class="keywordtype">id</span>, byte loggingID)</div><div class="line"><a name="l00038"></a><span class="lineno">   38</span>&#160;        {</div><div class="line"><a name="l00039"></a><span class="lineno">   39</span>&#160;            EventLog.WriteEntry(message, EventLogEntryType.Error, (<span class="keywordtype">int</span>)<span class="keywordtype">id</span> + loggingID);</div><div class="line"><a name="l00040"></a><span class="lineno">   40</span>&#160;        }</div><div class="line"><a name="l00041"></a><span class="lineno">   41</span>&#160;</div><div class="line"><a name="l00043"></a><span class="lineno"><a class="line" href="class_t_g_s_1_1_server_1_1_service_1_1_service.html#a5802bc85142b7429b43d4f8e57f801d5">   43</a></span>&#160;        <span class="keyword">public</span> <span class="keywordtype">void</span> <a class="code" href="class_t_g_s_1_1_server_1_1_service_1_1_service.html#a5802bc85142b7429b43d4f8e57f801d5">WriteInfo</a>(<span class="keywordtype">string</span> message, <a class="code" href="namespace_t_g_s_1_1_server.html#a4682739b9567dc9e4e5c327c253ce311">EventID</a> <span class="keywordtype">id</span>, byte loggingID)</div><div class="line"><a name="l00044"></a><span class="lineno">   44</span>&#160;        {</div><div class="line"><a name="l00045"></a><span class="lineno">   45</span>&#160;            EventLog.WriteEntry(message, EventLogEntryType.Information, (<span class="keywordtype">int</span>)<span class="keywordtype">id</span> + loggingID);</div><div class="line"><a name="l00046"></a><span class="lineno">   46</span>&#160;        }</div><div class="line"><a name="l00047"></a><span class="lineno">   47</span>&#160;</div><div class="line"><a name="l00049"></a><span class="lineno"><a class="line" href="class_t_g_s_1_1_server_1_1_service_1_1_service.html#a5ea55700c8707c646f82a2dd98cf1f82">   49</a></span>&#160;        <span class="keyword">public</span> <span class="keywordtype">void</span> <a class="code" href="class_t_g_s_1_1_server_1_1_service_1_1_service.html#a5ea55700c8707c646f82a2dd98cf1f82">WriteWarning</a>(<span class="keywordtype">string</span> message, <a class="code" href="namespace_t_g_s_1_1_server.html#a4682739b9567dc9e4e5c327c253ce311">EventID</a> <span class="keywordtype">id</span>, byte loggingID)</div><div class="line"><a name="l00050"></a><span class="lineno">   50</span>&#160;        {</div><div class="line"><a name="l00051"></a><span class="lineno">   51</span>&#160;            EventLog.WriteEntry(message, EventLogEntryType.Warning, (<span class="keywordtype">int</span>)<span class="keywordtype">id</span> + loggingID);</div><div class="line"><a name="l00052"></a><span class="lineno">   52</span>&#160;        }</div><div class="line"><a name="l00053"></a><span class="lineno">   53</span>&#160;</div><div class="line"><a name="l00058"></a><span class="lineno"><a class="line" href="class_t_g_s_1_1_server_1_1_service_1_1_service.html#a18dc084393124aad338e1367958f4c72">   58</a></span>&#160;        <span class="keyword">protected</span> <span class="keyword">override</span> <span class="keywordtype">void</span> <a class="code" href="class_t_g_s_1_1_server_1_1_service_1_1_service.html#a18dc084393124aad338e1367958f4c72">OnStart</a>(<span class="keywordtype">string</span>[] args)</div><div class="line"><a name="l00059"></a><span class="lineno">   59</span>&#160;        {</div><div class="line"><a name="l00060"></a><span class="lineno">   60</span>&#160;            activeServer = <span class="keyword">new</span> <a class="code" href="class_t_g_s_1_1_server_1_1_server.html">Server</a>(args, <span class="keyword">this</span>);</div><div class="line"><a name="l00061"></a><span class="lineno">   61</span>&#160;        }</div><div class="line"><a name="l00062"></a><span class="lineno">   62</span>&#160;</div><div class="line"><a name="l00066"></a><span class="lineno"><a class="line" href="class_t_g_s_1_1_server_1_1_service_1_1_service.html#a1ae0d4d9bb9690920d5757e8889e23e1">   66</a></span>&#160;        <span class="keyword">protected</span> <span class="keyword">override</span> <span class="keywordtype">void</span> <a class="code" href="class_t_g_s_1_1_server_1_1_service_1_1_service.html#a1ae0d4d9bb9690920d5757e8889e23e1">OnStop</a>()</div><div class="line"><a name="l00067"></a><span class="lineno">   67</span>&#160;        {</div><div class="line"><a name="l00068"></a><span class="lineno">   68</span>&#160;            activeServer.<a class="code" href="class_t_g_s_1_1_server_1_1_server.html#aa1d3d4bbc5df7a10114a49d78ff0bcb4">Dispose</a>();</div><div class="line"><a name="l00069"></a><span class="lineno">   69</span>&#160;        }</div><div class="line"><a name="l00070"></a><span class="lineno">   70</span>&#160;    }</div><div class="line"><a name="l00071"></a><span class="lineno">   71</span>&#160;}</div><div class="ttc" id="class_t_g_s_1_1_server_1_1_service_1_1_service_html_a00360dc1c721296437f17214fdd405df"><div class="ttname"><a href="class_t_g_s_1_1_server_1_1_service_1_1_service.html#a00360dc1c721296437f17214fdd405df">TGS.Server.Service.Service.WriteAccess</a></div><div class="ttdeci">void WriteAccess(string username, bool authSuccess, byte loggingID)</div><div class="ttdoc">Writes an access event to the log  </div><div class="ttdef"><b>Definition:</b> <a href="_t_g_s_8_server_8_service_2_service_8cs_source.html#l00031">Service.cs:31</a></div></div>
<div class="ttc" id="interface_t_g_s_1_1_server_1_1_i_logger_html"><div class="ttname"><a href="interface_t_g_s_1_1_server_1_1_i_logger.html">TGS.Server.ILogger</a></div><div class="ttdoc">Used for writing logs to a provider </div><div class="ttdef"><b>Definition:</b> <a href="_i_logger_8cs_source.html#l00006">ILogger.cs:6</a></div></div>
<div class="ttc" id="namespace_system_html"><div class="ttname"><a href="namespace_system.html">System</a></div></div>
<div class="ttc" id="namespace_t_g_s_html"><div class="ttname"><a href="namespace_t_g_s.html">TGS</a></div></div>
<div class="ttc" id="class_service_base_html"><div class="ttname"><a href="class_service_base.html">ServiceBase</a></div></div>
<div class="ttc" id="class_t_g_s_1_1_server_1_1_service_1_1_service_html"><div class="ttname"><a href="class_t_g_s_1_1_server_1_1_service_1_1_service.html">TGS.Server.Service.Service</a></div><div class="ttdoc">Windows ServiceBase adapter for Server </div><div class="ttdef"><b>Definition:</b> <a href="_t_g_s_8_server_8_service_2_service_8cs_source.html#l00010">Service.cs:10</a></div></div>
<div class="ttc" id="class_t_g_s_1_1_server_1_1_service_1_1_service_html_a1ae0d4d9bb9690920d5757e8889e23e1"><div class="ttname"><a href="class_t_g_s_1_1_server_1_1_service_1_1_service.html#a1ae0d4d9bb9690920d5757e8889e23e1">TGS.Server.Service.Service.OnStop</a></div><div class="ttdeci">override void OnStop()</div><div class="ttdoc">Called when the Service is stopped. Calls IDisposable.Dispose on activeServer </div><div class="ttdef"><b>Definition:</b> <a href="_t_g_s_8_server_8_service_2_service_8cs_source.html#l00066">Service.cs:66</a></div></div>
<div class="ttc" id="class_t_g_s_1_1_server_1_1_service_1_1_service_html_a5ea55700c8707c646f82a2dd98cf1f82"><div class="ttname"><a href="class_t_g_s_1_1_server_1_1_service_1_1_service.html#a5ea55700c8707c646f82a2dd98cf1f82">TGS.Server.Service.Service.WriteWarning</a></div><div class="ttdeci">void WriteWarning(string message, EventID id, byte loggingID)</div><div class="ttdoc">Writes a warning to the log  </div><div class="ttdef"><b>Definition:</b> <a href="_t_g_s_8_server_8_service_2_service_8cs_source.html#l00049">Service.cs:49</a></div></div>
<div class="ttc" id="_t_g_s_8_command_line_2_program_8cs_html_a81a223a02c34d82b47199f08308847f2"><div class="ttname"><a href="_t_g_s_8_command_line_2_program_8cs.html#a81a223a02c34d82b47199f08308847f2">System</a></div><div class="ttdeci">﻿using System</div><div class="ttdef"><b>Definition:</b> <a href="_t_g_s_8_command_line_2_program_8cs_source.html#l00001">Program.cs:1</a></div></div>
<div class="ttc" id="class_t_g_s_1_1_server_1_1_service_1_1_service_html_a18dc084393124aad338e1367958f4c72"><div class="ttname"><a href="class_t_g_s_1_1_server_1_1_service_1_1_service.html#a18dc084393124aad338e1367958f4c72">TGS.Server.Service.Service.OnStart</a></div><div class="ttdeci">override void OnStart(string[] args)</div><div class="ttdoc">Called when the Service is started. Creates a new activeServer </div><div class="ttdef"><b>Definition:</b> <a href="_t_g_s_8_server_8_service_2_service_8cs_source.html#l00058">Service.cs:58</a></div></div>
<div class="ttc" id="class_t_g_s_1_1_server_1_1_service_1_1_service_html_ab5fec892fdcf64809d41d6d7483659e6"><div class="ttname"><a href="class_t_g_s_1_1_server_1_1_service_1_1_service.html#ab5fec892fdcf64809d41d6d7483659e6">TGS.Server.Service.Service.activeServer</a></div><div class="ttdeci">Server activeServer</div><div class="ttdoc">The Server the Service manages </div><div class="ttdef"><b>Definition:</b> <a href="_t_g_s_8_server_8_service_2_service_8cs_source.html#l00020">Service.cs:20</a></div></div>
<div class="ttc" id="namespace_t_g_s_1_1_server_html_a4682739b9567dc9e4e5c327c253ce311"><div class="ttname"><a href="namespace_t_g_s_1_1_server.html#a4682739b9567dc9e4e5c327c253ce311">TGS.Server.EventID</a></div><div class="ttdeci">EventID</div><div class="ttdoc">Various events and their IDs in no particular order. Found in the Windows event log. These key incremented by 100 and are guaranteed to never be reused in the future. In the windows event viewer, these IDs will be offset by the Instance.LoggingID to distinguish events between instances. Each event ID may be information, a warning, or error and will be documented accordingly. Warnings will occur due to user, data, or network errors. Errors will occur due to filesystem errors or hard faults </div><div class="ttdef"><b>Definition:</b> <a href="_event_i_d_8cs_source.html#l00008">EventID.cs:8</a></div></div>
<div class="ttc" id="class_t_g_s_1_1_server_1_1_server_html_aa1d3d4bbc5df7a10114a49d78ff0bcb4"><div class="ttname"><a href="class_t_g_s_1_1_server_1_1_server.html#aa1d3d4bbc5df7a10114a49d78ff0bcb4">TGS.Server.Server.Dispose</a></div><div class="ttdeci">void Dispose(bool disposing)</div><div class="ttdoc">Implements the IDisposable pattern. Calls OnStop </div><div class="ttdef"><b>Definition:</b> <a href="_t_g_s_8_server_2_server_8cs_source.html#l00673">Server.cs:673</a></div></div>
<div class="ttc" id="class_t_g_s_1_1_server_1_1_server_html"><div class="ttname"><a href="class_t_g_s_1_1_server_1_1_server.html">TGS.Server.Server</a></div><div class="ttdoc">The windows service the application runs as </div><div class="ttdef"><b>Definition:</b> <a href="_t_g_s_8_server_2_server_8cs_source.html#l00017">Server.cs:17</a></div></div>
<div class="ttc" id="class_t_g_s_1_1_server_1_1_service_1_1_service_html_a5802bc85142b7429b43d4f8e57f801d5"><div class="ttname"><a href="class_t_g_s_1_1_server_1_1_service_1_1_service.html#a5802bc85142b7429b43d4f8e57f801d5">TGS.Server.Service.Service.WriteInfo</a></div><div class="ttdeci">void WriteInfo(string message, EventID id, byte loggingID)</div><div class="ttdoc">Writes information to the log  </div><div class="ttdef"><b>Definition:</b> <a href="_t_g_s_8_server_8_service_2_service_8cs_source.html#l00043">Service.cs:43</a></div></div>
<div class="ttc" id="class_t_g_s_1_1_server_1_1_service_1_1_service_html_ac6439b90f7bec025e8a71849b5174710"><div class="ttname"><a href="class_t_g_s_1_1_server_1_1_service_1_1_service.html#ac6439b90f7bec025e8a71849b5174710">TGS.Server.Service.Service.Service</a></div><div class="ttdeci">Service()</div><div class="ttdoc">Constructs a Service </div><div class="ttdef"><b>Definition:</b> <a href="_t_g_s_8_server_8_service_2_service_8cs_source.html#l00025">Service.cs:25</a></div></div>
<div class="ttc" id="class_t_g_s_1_1_server_1_1_service_1_1_service_html_a00104d3e06744d907e963ebf4472cb5d"><div class="ttname"><a href="class_t_g_s_1_1_server_1_1_service_1_1_service.html#a00104d3e06744d907e963ebf4472cb5d">TGS.Server.Service.Service.WriteError</a></div><div class="ttdeci">void WriteError(string message, EventID id, byte loggingID)</div><div class="ttdoc">Writes an error to the log  </div><div class="ttdef"><b>Definition:</b> <a href="_t_g_s_8_server_8_service_2_service_8cs_source.html#l00037">Service.cs:37</a></div></div>
</div><!-- fragment --></div><!-- contents -->
<!-- start footer part -->
<hr class="footer"/><address class="footer"><small>
Generated by &#160;<a href="http://www.doxygen.org/index.html">
<img class="footer" src="doxygen.png" alt="doxygen"/>
</a> 1.8.11
</small></address>
</body>
</html>
